---
layout: user_guide
title: Pangool - User guide - Text I/O
---
<div class="hero-unit">
	<h1>Pangool User Guide</h1>
</div>

<h1>Text Input/Output</h1>

<p>
Pangool comes with a convenient InputFormat and OutputFormat for text files, which extend Hadoop's functionality to allow reading TSV / CSV, including the possibility of specifying arbitrary parsing specs and "null strings".   
</p>

<h3>Using TupleTextInputFormat</h3>

<p><a href='http://pangool.net/apidocs/com/datasalt/pangool/tuplemr/mapred/lib/input/TupleTextInputFormat.html'>TupleTextInputFormat</a>'s constructor has several available options:</p>

<ul>
	<li><b>schema</b>: The target schema to use. A Tuple with this schema will be instantiated and fed into the Mapper.</li>
	<li><b>hasHeader</b>: If true, the reader will skip the first line of every file.</li>
	<li><b>strictQuotes</b>: If true, the reader will provide null values for any value which is not quoted.</li>
	<li><b>separator</b>: The character used to separate fields in the input files.</li>
	<li><b>quoteCharacter</b>: The character used to quote fields in the input files. Use NO_QUOTE_CHARACTER if the file has no quotes.</li>
	<li><b>escapeCharacter</b>: The character used to escape characters inside quoted fields in the input files. Use NO_ESCAPE_CHARACTER if the file has no escape character.</li>
	<li><b>fieldSelector</b>: An optional 0-index based selector that allows to read only some columns of the input files. The selector must match the target schema. That is, no matter how many columns the original file has, if the selector has 5 selected fields then the target schema must have 5 fields. Use null if no explicit field selection is needed.</li>
	<li><b>nullString</b>: A string which can be identified as null value (e.g. \N in MySQL dumps). Use null if no nullString is needed.</li>
</ul>

<p>The following line instantiates an InputFormat which reads a simple TSV with no quotes nor escape characters:</p>

<pre class="prettyprint" id="java">
 InputFormat inputFormat = new TupleTextInputFormat(schema, false, false, '\t', 
  TupleTextInputFormat.NO_QUOTE_CHARACTER, TupleTextInputFormat.NO_ESCAPE_CHARACTER, null, null);
</pre>

<p>The following line instantiates an InputFormat which reads a header-less CSV which uses " as quote character and \ as escape character:</p>

<pre class="prettyprint" id="java">
 InputFormat inputFormat = new TupleTextInputFormat(schema, false, false, ',', '"', '\\', null, null);
</pre>

<p>The following line instantiates an InputFormat which reads strict quotes CSV files with header and null values optionally identified as \N, and selects only columns 1, 4 and 6 (remember that indexes are 0-based):</p> 

<pre class="prettyprint" id="java">
 FieldSelector selector = new FieldSelector(1, 4, 6);
 InputFormat inputFormat = new TupleTextInputFormat(schema, true, true, ',', '"', '\\', selector, "\\N");
</pre>

<h3>Using TupleTextOutputFormat</h3>

<p><a href='http://pangool.net/apidocs/com/datasalt/pangool/tuplemr/mapred/lib/output/TupleTextOutputFormat.html'>TupleTextOutputFormat</a>'s constructor has several available options, similar to those in TupleTextInputFormat:</p>

<ul>
	<li><b>schema</b>: The target schema to use. A Tuple with this schema will be instantiated and fed into the Mapper.</li>
	<li><b>addHeader</b>: If true, the writer will append a header line to every produced file.</li>
	<li><b>separatorCharacter</b>: The character to use for separating fields.</li>
	<li><b>quoteCharacter</b>: The character used to quote fields. If provided, output will be strictly quoted. Use NO_QUOTE_CHARACTER to not use quotes.</li>
	<li><b>escapeCharacter</b>: The character used to escape characters inside quoted fields. Used if quoteCharacter is provided. Use NO_ESCAPE_CHARACTER to not use it.</li>
	<li><b>nullString</b>: An optional string which can be used to serialize null values (e.g. \N as in MySQL dumps). Use null if no nullString is needed. If provided, this string won't be quoted even if the writer uses quotes.</li>
</ul>

<p>The following line instantiates a TupleTextOutputFormat which serializes tuples as a simple TSV:</p>

<pre class="prettyprint" id="java">
 OutputFormat outputFormat = new TupleTextOutputFormat(schema, false, '\t', 
  TupleTextOutputFormat.NO_QUOTE_CHARACTER, TupleTextOutputFormat.NO_ESCAPE_CHARACTER);
</pre>
	
<p>The following line instantiates a TupleTextOutputFormat which serializes tuples as strictly quoted CSV with null strings as \N :</p>

<pre class="prettyprint" id="java">
 OutputFormat outputFormat = new TupleTextOutputFormat(schema, true, ',', '"', '\\', "\\N")
</pre>

<h3>Advanced: Fixed-width fields reader</h3>

<p>Some input text files have fixed-width fields. In this case there is no way to parse the file using delimiters, etc. Pangool also
supports such files via a special constructor in <code>TupleTextInputFormat</code>. The following code instantiates an InputFormat
that reads a fixed-width fields file with two fields:</p>

<pre class="prettyprint" id="java">
 int fieldsPos[] = new int[] { 0, 3, 4, 5 };
 InputFormat inputFormat = new TupleTextInputFormat(schema, fieldsPos, false, "-");
</pre>

<p>The <code>fieldsPos</code> array is interpreted by taking pairs of consecutive numbers which indicate the absolute char position
where every field starts. In this example, there are two fields: the first one is read from chars 0 to 3 and the second one from
chars 4 to 5.</p>

<p><a class="btn btn-primary btn-large" href="solrintegration.html">Next: SOLR Integration &raquo;</a></p>