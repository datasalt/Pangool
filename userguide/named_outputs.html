---
layout: user_guide
title: Pangool - User guide - Named outputs
---
<div class="hero-unit">
	<h1>Pangool User Guide</h1>
</div>

<h1>Named outputs</h1>

<p>
Thanks to the <strong>"named outputs"</strong> feature, Pangool offers the ability of having <strong>more than
one output</strong> per <code>TupleMapper</code> or <code>TupleReducer</code>. Note that named outputs don't replace the main job output. They are extra outputs added to the job.
</p>

<h3>Adding named outputs</h3>
You can add named outputs to a Pangool job in the <code>TupleMRBuilder</code> in the following way:

<pre class="prettyprint" id="java">
 mr.addNamedOutput("urls", new HadoopOutputFormat(SequenceFileOutputFormat.class), Text.class, Text.class);
</pre>

<p> 
You can add as many as you want. It will then be possible to write to each of the named outputs from the mapper or the reducer in the following way:</p>

<pre class="prettyprint" id="java">
 collector.getNamedOutput("urls").write(new Text("http://www.datasalt.com"), new Text("<html>...</html>"));
</pre> 

<p>
If you want to put away the lookup of the named output for every write, you can cache it up in
the <code>setup()</code> method. 
<p>

<h3>Default named output</h3>

<p>You can avoid declaring a huge amount of named outputs by using the methods <code>setDefaultNamedOutput(...)</code>. By declaring a default "spec", you can open an arbitrary named output from your Mapper or Reducer and its format will default to that which has been defined there.</p>

<h3>Named outputs for tuples</h3>
<p>
Pangool allows us to persist Tuples in binary format by using 
<code>TupleOutputFormat</code>. The code below shows how easy it is to add a named output 
for persisting tuples:
</p>

<h3>Specific context</h3>

<p>Some Hadoop-based OutputFormats may require properties in the Hadoop Configuration for operating. Because Pangool can have an arbitrary number of those opened at a time, it can't use the Job's Configuration object for that purpose. In order to overcome this limitation some methods that configure named outputs accept a <code>Map&lt;String, String&gt;</code> which can be used
to pass specific key, value configuration pairs to every named output.</p> 

<pre class="prettyprint" id="java">
 Schema urlsSchema = new Schema("schema", Fields.parse("url:string, content:string"));
 mr.addNamedTupleOutput("urls", urlsSchema);
</pre>

<p>
Then it is possible to write tuples from the mapper or the reducer in the following way:
</p>  

<pre class="prettyprint" id="java">
 Tuple tuple = new Tuple(urlsSchema);
 tuple.set("url", "http://www.datasalt.com");
 tuple.set("content", "<html>...</html>");
 collector.getNamedOutput("urls").write(tuple, NullWritable.get());
</pre> 

<div class="alert alert-info">
Note that you have to use <code>NullWritable</code> as a second parameter in 
the <code>write()</code> method. This is a small bureaucracy needed in order to be compatible with the Hadoop "key, value" API.
</div>

<h3>Folder structure</h3>
<p>
Let's imagine that you have a Pangool job with 2 named outputs:
</p>

<ul>
<li>urls</li>
<li>other_named_output</li>
</ul>

<p>
Your job uses the <code>urls</code> named output for writing from the
mapper and from the reducer, but it only writes to the <code>other_named_output</code>
from the reducer. Let's imagine that our job has 2 map tasks and 3 reduce tasks. 
Then, the output folder will look like that:
</p>

<pre>
 ── job_output
    ├── urls
    │   ├── part-r-00000
    │   ├── part-r-00001
    │   ├── part-r-00002
    │   ├── part-m-00000
    │   └── part-m-00001
    ├── other_named_output
    │   ├── part-r-000000
    │   ├── part-r-000001
    │   └── part-r-000002
    ├── part-r-00000
    ├── part-r-00001
    └── part-r-00002
</pre> 

<p>
<code>part-m</code> files correspond
to the mapper output. <code>part-r</code> files corresponds to the reducer output.
</p> 

<p>
The part-r files in the root correspond to the records emitted from the main job's output.
That is, the ones emitted by calling to <code>collector.write()</code>
</p>

<p><a class="btn btn-primary btn-large" href="joins.html">Next: Reduce-side Joins &raquo;</a></p>