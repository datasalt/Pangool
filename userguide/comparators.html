---
layout: user_guide
title: Pangool - User guide - Custom Comparators
---
<div class="hero-unit">
	<h1>Pangool User Guide</h1>
</div>

<h1>Custom Comparators</h1>

<p>
You can use your own custom RawComparator for comparing a field in a Tuple. This can be specified in the sort by configuration, for example:
</p>

<pre class="prettyprint" id="java">
 cg.setOrderBy(new SortBy().add("word", Order.DESC, new MyUtf8Comparator()));
</pre>

<p>
Example:
</p>

<pre class="prettyprint" id="java">
 private static class MyUtf8Comparator implements RawComparator&lt;Text&gt;, Serializable {
   public int compare(Text arg0, Text arg1) {
     throw new NotImplementedException();
   }

   public int compare(byte[] buf1, int off1, int len1, byte[] buf2, int off2, int len2) {
     if(len1 > len2) {
       return 1;
     } else if(len1 < len2) {
       return -1;
     } else {
       return 0;
     }
   }
 }
</pre>

<p>
In case that you need to deserialize your object in order to compare it, you can subclass
<a href="https://github.com/datasalt/pangool/blob/master/core/src/main/java/com/datasalt/pangool/tuplemr/mapred/BaseComparator.java">BaseComparator</a>
and then just compare objects.<br>
For instance, let's define a <i>Thrift</i> object whose definition is : 
</p>

<pre class="prettyprint" id="java">
 struct MyThriftObject {
   1: string userName,
   2: int age
 }
</pre>


<p>
Then your custom comparator could look like this:
</p>
<pre class="prettyprint" id="java">
 public class MyThriftComparator extends BaseComparator&lt;MyThriftObject&gt; {

   public MyThriftComparator(){
     super(Type.OBJECT,MyThriftObject.class);   
   }
  
   public int compare(MyThriftObject a, MyThriftObject b){
     return a.getUserName().compareTo(b.getUserName());
   }
 }
</pre>

<div class="alert">
<strong>Important</strong>: For cases like above, where just one field needs to be compared,
we don't recommend using custom comparators.<br>Due to efficiency concerns it's more desirable 
to duplicate fields out of the serialized object and then perform the comparison using basic types.
</div>

<p><a class="btn btn-primary btn-large" href="text_io.html">Next: Text Input/Output &raquo;</a></p>